<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Western Spritz ‚Äî Line Dance Library</title>

  <link rel="stylesheet" href="./style.css?v=11" />
  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="apple-touch-icon" href="./assets/images/icon.png" />
  <link rel="icon" href="./assets/images/icon.png" />
  <meta name="theme-color" content="#000000" />
</head>
<body>
  <!-- BACKGROUND -->
  <div id="bg-blur" aria-hidden="true"></div>
  <div id="bg-main" aria-hidden="true"></div>

  <!-- SPLASH -->
  <section id="splash" class="splash">
    <img class="splash-img" src="./assets/images/gruppo.png" alt="Western Spritz" />
    <p class="hint">Tocca ‚ÄúAvvia‚Äù per entrare</p>
    <button id="startBtn" class="btn btn-primary">Avvia</button>
  </section>
  <audio id="introMusic" src="./assets/audio/some_people.mp3" preload="auto"></audio>

  <!-- HEADER -->
  <header class="hero">
    <h1>Western Spritz ‚Äî Line Dance Library</h1>
    <div id="count" class="count">Brani trovati: 0</div>

    <div class="filters">
      <input id="fDance" class="input" placeholder="Filtra per titolo del ballo‚Ä¶" />
      <input id="fSong"  class="input" placeholder="Filtra per titolo della canzone‚Ä¶" />
      <button id="clearFilters" class="btn btn-ghost">Pulisci</button>
      <button id="updateApp" class="btn btn-primary" title="Forza aggiornamento app">Aggiorna app</button>
      <button id="openPuzzle" class="btn btn-primary" title="Avvia il Puzzle">üéØ Gioco Puzzle</button>
    </div>
  </header>

  <!-- LISTA -->
  <main id="cards" class="cards" aria-live="polite"></main>

  <footer class="footer">
    Western Spritz ‚Ä¢ Aggiungi l‚Äôapp alla Home per un‚Äôesperienza migliore
  </footer>

  <!-- AUDIO EFFETTI -->
  <audio id="fxCrack"   src="./assets/audio/frusta.mp3"    preload="auto"></audio>
  <audio id="fxCorrect" src="./assets/audio/correct.mp3"   preload="auto"></audio>
  <audio id="fxWrong"   src="./assets/audio/wrong.mp3"     preload="auto"></audio>
  <audio id="fxWin"     src="./assets/audio/correct.mp3"   preload="auto"></audio>
  <audio id="fxGun"     src="./assets/audio/gun_shot.mp3"  preload="auto"></audio>

  <!-- OVERLAY PUZZLE -->
  <section id="puzzleOverlay" class="pz hidden" aria-hidden="true">
    <div class="pz-wrap">
      <button id="pzClose" class="pz-close" aria-label="Chiudi">√ó</button>

      <!-- HUD -->
      <div class="pz-hud">
        <div class="pz-info">
          <span id="pzTime">00:00</span> ‚Ä¢ <span id="pzProgress">0/16</span>
        </div>
        <div class="pz-diff">
          <button class="diff-btn" data-grid="3">3√ó3</button>
          <button class="diff-btn active" data-grid="4">4√ó4</button>
          <button class="diff-btn" data-grid="5">5√ó5</button>
        </div>
      </div>

      <!-- riempimento blur + immagine -->
      <div id="pzBlur" class="pz-blur"></div>
      <img id="pzImg" class="pz-img" alt="Puzzle" />

      <!-- griglia tasselli -->
      <div id="pzGrid" class="pz-grid"></div>

      <!-- ‚ÄúNo‚Äù -->
      <img id="pzNo" src="./assets/images/alessia.png" alt="No" class="pz-no hidden" />

      <!-- Domande/risposte -->
      <div class="pz-card">
        <div id="pzQuestion" class="pz-q">Domanda‚Ä¶</div>
        <div id="pzAnswers" class="pz-answers"></div>
        <div class="pz-actions">
          <button id="pzQuit" class="btn btn-ghost">Torna indietro</button>
        </div>
      </div>

      <!-- Bravo -->
      <div id="pzBravo" class="pz-bravo hidden">
        <div class="pz-bravo-msg">BRAVO! üéâ</div>
        <div class="pz-bravo-sub">Tocca per ricominciare</div>
      </div>
    </div>
  </section>

  <!-- JS -->
  <script src="./app.js?v=11"></script>

  <!-- Splash + Service Worker -->
  <script>
    (function () {
      const splash = document.getElementById('splash');
      const startBtn = document.getElementById('startBtn');
      const intro = document.getElementById('introMusic');
      startBtn?.addEventListener('click', async () => {
        try { await intro.play(); } catch(e) {}
        setTimeout(() => splash?.remove(), 3000);
      });
    })();

    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js?v=11')
          .then(reg => console.log('[SW] registrato', reg.scope))
          .catch(err => console.warn('[SW] errore', err));
      });
    }
  </script>
</body>
</html>
